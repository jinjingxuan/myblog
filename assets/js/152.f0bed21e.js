(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{657:function(t,a,s){"use strict";s.r(a);var e=s(14),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"前端安全简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端安全简介"}},[t._v("#")]),t._v(" 前端安全简介")]),t._v(" "),a("ul",[a("li",[t._v("XSS")]),t._v(" "),a("li",[t._v("CSRF")]),t._v(" "),a("li",[t._v("点击劫持")]),t._v(" "),a("li",[t._v("HTTP传输安全")]),t._v(" "),a("li",[t._v("中间人攻击")]),t._v(" "),a("li",[t._v("第三方依赖安全")]),t._v(" "),a("li",[t._v("控制台注入代码")]),t._v(" "),a("li",[t._v("钓鱼")]),t._v(" "),a("li",[t._v("扩展")])]),t._v(" "),a("h2",{attrs:{id:"xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss"}},[t._v("#")]),t._v(" XSS")]),t._v(" "),a("blockquote",[a("p",[t._v("XSS指的是恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意攻击用户的特殊目的。简单举一个例子（dom型）")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-html")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("el")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src 不存在从而触发 onerror")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('<img src="xxx" onerror="alert(document.cookie)">')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" `"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("`\n\t\t}\n})\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h3",{attrs:{id:"xss危害"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss危害"}},[t._v("#")]),t._v(" XSS危害")]),t._v(" "),a("ul",[a("li",[t._v("窃取 cookie")]),t._v(" "),a("li",[t._v("按键记录和钓鱼")]),t._v(" "),a("li",[t._v("未授权操作")]),t._v(" "),a("li",[t._v("获取页面数据")]),t._v(" "),a("li",[t._v("劫持前端逻辑")]),t._v(" "),a("li",[t._v("偷取用户资料")]),t._v(" "),a("li",[t._v("...")])]),t._v(" "),a("blockquote",[a("p",[t._v("XSS的攻击一般分为以下几类：反射型XSS，存储型XSS，DOM XSS。")]),t._v(" "),a("p",[t._v("反射型和存储型在纯前端渲染中已经很少见了，尤其在第三方框架下")])]),t._v(" "),a("h4",{attrs:{id:"反射型xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反射型xss"}},[t._v("#")]),t._v(" 反射型XSS")]),t._v(" "),a("blockquote",[a("p",[t._v("用户在一个不防范 XSS 的网站中搜索内容，关键字为 XXX，如果网站内包含 XXX的内容，那么该内容就会被展示出来，如果网站中不包含相关，那么可能会提示 XXX 相关内容不存在。也就是，用户的搜索内容最终都会以某种方式反射到搜索结果中。如果搜索内容为："),a("code",[t._v("<script>alert(1)<\/script>")]),t._v("，那么页面就会执行这段 JavaScript 代码，也即该网站存在 XSS 漏洞。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// node 服务端 app.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 读取渲染页面的内容")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2, 将渲染结果发送给客户端")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index.html'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("search")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过地址栏传递")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://loalhost:3000/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- index.html --\x3e")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("form")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("GET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 输入框内输入 <script>alert(document.cookie)<\/script> --\x3e")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("search"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("搜索"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("form")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n{{ if search }}\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" 展示搜索内容 "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\t\n{{ /if }}\n")])])]),a("h4",{attrs:{id:"存储型xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存储型xss"}},[t._v("#")]),t._v(" 存储型XSS")]),t._v(" "),a("ul",[a("li",[t._v("攻击者将恶意代码提交到目标网站的数据库中")]),t._v(" "),a("li",[t._v("用户打开目标网站时，服务端将恶意代码从数据库中取出，拼接在html中返回给浏览器")]),t._v(" "),a("li",[t._v("用户浏览器接收响应解析时，取出恶意代码执行")]),t._v(" "),a("li",[t._v("这种攻击常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。")])]),t._v(" "),a("blockquote",[a("p",[t._v("比如一个富文本编辑器，产生的结果：html格式的字符串，web后台存储到数据库中")]),t._v(" "),a("p",[t._v("当其他用户查看文章详情时，就会渲染文章内容，将恶意代码执行")])]),t._v(" "),a("h4",{attrs:{id:"dom型xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dom型xss"}},[t._v("#")]),t._v(" DOM型XSS")]),t._v(" "),a("blockquote",[a("p",[t._v("DOM 型 XSS 攻击，实际上就是网站前端 JavaScript 代码本身不够严谨，把不可信的数据当作代码执行了。")]),t._v(" "),a("p",[t._v("在使用 "),a("code",[t._v(".innerHTML")]),t._v("、"),a("code",[t._v(".outerHTML")]),t._v("、"),a("code",[t._v("document.write()")]),t._v(" 时要特别小心，不要把不可信的数据作为 HTML 插到页面上，而应尽量使用 "),a("code",[t._v(".textContent")]),t._v("、"),a("code",[t._v(".setAttribute()")]),t._v(" 等。")]),t._v(" "),a("p",[t._v("如果用 Vue/React 技术栈，并且不使用 "),a("code",[t._v("v-html")]),t._v("/"),a("code",[t._v("dangerouslySetInnerHTML")]),t._v(" 功能，就在前端 render 阶段避免 "),a("code",[t._v("innerHTML")]),t._v("、"),a("code",[t._v("outerHTML")]),t._v(" 的 XSS 隐患。")]),t._v(" "),a("p",[t._v("DOM 中的内联事件监听器，如 "),a("code",[t._v("location")]),t._v("、"),a("code",[t._v("onclick")]),t._v("、"),a("code",[t._v("onerror")]),t._v("、"),a("code",[t._v("onload")]),t._v("、"),a("code",[t._v("onmouseover")]),t._v(" 等，"),a("code",[t._v("<a>")]),t._v(" 标签的 "),a("code",[t._v("href")]),t._v(" 属性，JavaScript 的 "),a("code",[t._v("eval()")]),t._v("、"),a("code",[t._v("setTimeout()")]),t._v("、"),a("code",[t._v("setInterval()")]),t._v(" 等，都能把字符串作为代码运行。如果不可信的数据拼接到字符串中传递给这些 API，很容易产生安全隐患，请务必避免。")]),t._v(" "),a("p",[t._v("DOM 型和前两种的区别：DOM 型 XSS中，取出和执行恶意代码由浏览器端完成，其他两种都属于服务端安全漏洞")])]),t._v(" "),a("h3",{attrs:{id:"xss-攻击注入点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss-攻击注入点"}},[t._v("#")]),t._v(" XSS 攻击注入点")]),t._v(" "),a("ul",[a("li",[t._v("HTML中内嵌文本，恶意代码以 script 标签注入")]),t._v(" "),a("li",[t._v("标签的 href, src 等属性中，包含 javascript 等可执行代码")]),t._v(" "),a("li",[t._v("在 onload, onerror, onclick 等事件中")]),t._v(" "),a("li",[t._v('style 属性和标签中，包含 background-image: url("javascript")')]),t._v(" "),a("li",[t._v("style 属性和标签中，包含 expression(...) 的 CSS 表达式代码")])]),t._v(" "),a("h3",{attrs:{id:"xss-防御"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss-防御"}},[t._v("#")]),t._v(" XSS 防御")]),t._v(" "),a("p",[t._v("XSS 攻击有两大要素：")]),t._v(" "),a("ul",[a("li",[t._v("攻击者提交恶意代码")]),t._v(" "),a("li",[t._v("浏览器执行恶意代码")])]),t._v(" "),a("p",[t._v("常见解决办法：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("服务端可以通过设置 HttpOnly 来防止XSS代码获取到用户的cookie")])]),t._v(" "),a("li",[a("p",[t._v("纯前端渲染，将代码和数据分隔开")]),t._v(" "),a("ul",[a("li",[t._v("浏览器先加载一个静态HTML，此HTML不包含任何跟业务相关数据")]),t._v(" "),a("li",[t._v("然后浏览器执行 HTML 中的 Javascript")]),t._v(" "),a("li",[t._v("Javascript 通过 Ajax加载业务数据，调用 DOM API 更新到页面上")]),t._v(" "),a("li",[t._v("避免在前端代码中出现html拼接的情况")]),t._v(" "),a("li",[t._v("我们会明确的告诉浏览器：下面要设置的内容是文本（.innerText），还是属性（.setAttribute），还是样式（.style）等等。浏览器不会被轻易的被欺骗，执行预期外的代码了。")])])]),t._v(" "),a("li",[a("p",[t._v("对 HTML 做充分转义")]),t._v(" "),a("ul",[a("li",[t._v("& < > \" ' /'")]),t._v(" "),a("li",[t._v("转义库 js-xss")])])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSP：内容安全策略(HTTP响应头、meta标签)"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("一个CSP兼容的浏览器将会仅执行从白名单域获取到的脚本文件，忽略所有的其他脚本")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.ruanyifeng.com/blog/2016/09/csp.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.ruanyifeng.com/blog/2016/09/csp.html"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-XSS-Protection",target:"_blank",rel:"noopener noreferrer"}},[t._v("X-Xss-Protection(HTTP响应头)"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("HTTP "),a("strong",[a("code",[t._v("X-XSS-Protection")])]),t._v(" 响应头是 Internet Explorer，Chrome 和 Safari 的一个特性，当检测到跨站脚本攻击 ("),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting",target:"_blank",rel:"noopener noreferrer"}},[t._v("XSS"),a("OutboundLink")],1),t._v(")时，浏览器将停止加载页面。")])])])]),t._v(" "),a("h2",{attrs:{id:"csrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrf"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://juejin.cn/post/6844904004288249870",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSRF"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("XSS 利用的是网站对用户（输入）的信任，而CSRF 利用的是网站对用户网页浏览器的信任。")])])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://pic002.cnblogs.com/img/hyddd/200904/2009040916453171.jpg",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSRF图示"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("CSRF通常从第三方网站发起，被攻击的网站无法防止攻击发生，只能通过增强自己网站针对CSRF的防护能力来提升安全性")])]),t._v(" "),a("li",[a("p",[t._v("CSRF的两个特点：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("CSRF（通常）发生在第三方域名。")])]),t._v(" "),a("li",[a("p",[t._v("CSRF攻击者不能获取到Cookie等信息，只是使用。")])])])])]),t._v(" "),a("p",[a("strong",[t._v("如何防御")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("同源检测")]),t._v(" "),a("ul",[a("li",[t._v("Referer：但攻击者可以隐藏 Referer")]),t._v(" "),a("li",[t._v("Origin：但在 ie11 或者 302 时 origin 不存在")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("img")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://bank.example/withdraw?amount=10000&for=hacker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("referrerpolicy")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("no-referrer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" \n")])])]),a("blockquote",[a("p",[t._v("根据 HTTP 协议，在 HTTP 头中有一个字段叫 Referer，它记录了该 HTTP 请求的来源地址。")]),t._v(" "),a("p",[t._v("如果黑客要对银行网站实施 CSRF 攻击，他只能在他自己的网站构造请求，当用户通过黑客的网站发送请求到银行时，该请求的 Referer 是指向黑客自己的网站。因此，要防御 CSRF 攻击，银行网站只需要对于每一个转账请求验证其 Referer 值 。")]),t._v(" "),a("p",[t._v("然而，这种方法并非万无一失。Referer 的值是由浏览器提供的 ，目前已经有一些方法可以篡改 Referer 值 。")]),t._v(" "),a("p",[t._v("即便是使用最新的浏览器，黑客无法篡改 Referer 值，这种方法仍然有问题。因为 Referer 值会记录下用户的访问来源，有些用户认为这样会侵犯到他们自己的隐私权，因此，用户自己可以设置浏览器使其在发送请求时不再提供 Referer。当他们正常访问银行网站时，网站会因为请求没有 Referer 值而认为是 CSRF 攻击，拒绝合法用户的访问。")])])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2019/09/cookie-samesite.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Samesite Cookie"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[a("p",[t._v("strict：完全禁止第三方 Cookie")])]),t._v(" "),a("li",[a("p",[t._v("lax：大多数情况也是不发送第三方 Cookie")])]),t._v(" "),a("li",[a("p",[t._v("None：Chrome 计划将"),a("code",[t._v("Lax")]),t._v("变为默认设置。这时，网站可以选择显式关闭"),a("code",[t._v("SameSite")]),t._v("属性，将其设为"),a("code",[t._v("None")]),t._v("。不过，前提是必须同时设置"),a("code",[t._v("Secure")]),t._v("属性（Cookie 只能通过 HTTPS 协议发送），否则无效。")])]),t._v(" "),a("li",[a("p",[t._v("goole浏览器的设置（chrome 91版本后已移除，默认值为 lax）")]),t._v(" "),a("h4",{attrs:{id:"samesite-by-default-cookies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#samesite-by-default-cookies"}},[t._v("#")]),t._v(" SameSite by default cookies")]),t._v(" "),a("blockquote",[a("p",[t._v("Treat cookies that don't specify a SameSite attribute as if they were SameSite=Lax. Sites must specify SameSite=None in order to enable third-party usage. – Mac, Windows, Linux, Chrome OS, Android")]),t._v(" "),a("p",[t._v("将未指定SameSite属性的cookie视为SameSite=Lax(默认),网站必须指定SameSite=None才能启用第三方cookie。\n把这个设置关了就允许所有的第三方cookie")])]),t._v(" "),a("h4",{attrs:{id:"cookies-without-samesite-must-be-secure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cookies-without-samesite-must-be-secure"}},[t._v("#")]),t._v(" Cookies without SameSite must be secure")]),t._v(" "),a("blockquote",[a("p",[t._v('If enabled, cookies without SameSite restrictions must also be Secure. If a cookie without SameSite restrictions is set without the Secure attribute, it will be rejected. This flag only has an effect if "SameSite by default cookies" is also enabled. – Mac, Windows, Linux, Chrome OS, Android')]),t._v(" "),a("p",[t._v("如果启用，没有SameSite限制的cookie也必须是安全的。如果没有设置SameSite限制的cookie没有Secure属性，它将被拒绝。此标志仅在启用'sameSite by default cookies'时有效。")])]),t._v(" "),a("p",[t._v("如果你想加 SameSite=none 属性，那么该 Cookie 就必须同时加上 Secure 属性，表示只有在 HTTPS 协议下该 Cookie 才会被发送。")])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/cdfb7d0f69a7",target:"_blank",rel:"noopener noreferrer"}},[t._v("iframe samesite问题"),a("OutboundLink")],1)])])])]),t._v(" "),a("li",[a("p",[t._v("CSRF Token")]),t._v(" "),a("blockquote",[a("p",[t._v("CSRF 攻击之所以能够成功，是因为黑客可以完全伪造用户的请求，该请求中所有的用户验证信息都是存在于 cookie 中，因此黑客可以在不知道这些验证信息的情况下直接利用用户自己的 cookie 来通过安全验证。要抵御 CSRF，关键在于在请求中放入黑客所不能伪造的信息，并且该信息不存在于 cookie 之中。可以在 HTTP 请求中以参数的形式加入一个随机产生的 token，并在服务器端建立一个拦截器来验证这个 token，如果请求中没有 token 或者 token 内容不正确，则认为可能是 CSRF 攻击而拒绝该请求。")]),t._v(" "),a("p",[t._v("这种方法要比检查 Referer 要安全一些，token 可以在用户登陆后产生并放于 session 之中，然后在每次请求时把 token 从 session 中拿出，与请求中的 token 进行比对，但这种方法的难点在于如何把 token 以参数的形式加入请求。 在一个网站中，可以接受请求的地方非常多，要对于每一个请求都加上 token 是很麻烦的")])])]),t._v(" "),a("li",[a("p",[t._v("验证码")]),t._v(" "),a("blockquote",[a("p",[t._v("CSRF攻击是伪造成用户的身份，自动发起恶意的请求。那么我们可以强迫攻击者与我们的网站进行交互。在一些操作之前加入验证码校验，可以抵御一部分的CSRF攻击。但是加入验证码会影响用户的体验，所以验证码不能作为主要的防御手段。")])])])]),t._v(" "),a("h2",{attrs:{id:"点击劫持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#点击劫持"}},[t._v("#")]),t._v(" 点击劫持")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://cdn.nlark.com/yuque/0/2020/png/152778/1608265590815-5fdff14b-6acd-4265-9593-dbb409e5d538.png?x-oss-process=image%2Fresize%2Cw_1038",target:"_blank",rel:"noopener noreferrer"}},[t._v("点击劫持图示"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("点击劫持是一种视觉欺骗的攻击手段。")]),t._v(" "),a("p",[t._v("黑客创建一个网页利用 iframe 包含目标网站；")]),t._v(" "),a("p",[t._v("构造网页，诱变用户点击特点按钮。")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("防御手段")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("JavaScript 禁止内嵌")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("window.top")]),t._v(" 属性返回当前窗口的最顶层浏览器窗口对象，在 iframe 中的 "),a("code",[t._v("window")]),t._v(" 指的是 iframe 窗口对象")])]),t._v(" "),a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("top"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  top"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("X-FRAME-OPTIONS 响应头禁止内嵌")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("DENY")]),t._v("：表示页面不允许在 frame 中展示，即便是在相同域名的页面中嵌套也不允许。")]),t._v(" "),a("li",[a("code",[t._v("SAMEORIGIN")]),t._v("：表示该页面可以在相同域名页面的 frame 中展示。")]),t._v(" "),a("li",[a("code",[t._v("ALLOW-FROM url")]),t._v("：表示该页面可以在指定来源的 frame 中展示。")])])])])])]),t._v(" "),a("h2",{attrs:{id:"http传输安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http传输安全"}},[t._v("#")]),t._v(" HTTP传输安全")]),t._v(" "),a("ul",[a("li",[t._v("http 明文传输不安全")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.jinjingxuan.com/2020/11/23/%E6%95%B4%E7%90%86-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%9B%B8%E5%85%B3/#toc-heading-6",target:"_blank",rel:"noopener noreferrer"}},[t._v("网络协议相关"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"中间人攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#中间人攻击"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.cnblogs.com/lulianqi/p/10558719.html#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D",target:"_blank",rel:"noopener noreferrer"}},[t._v("中间人攻击"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("客户端发送请求到服务端，请求被中间人截获。\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("服务器向客户端发送公钥。\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("中间人截获公钥，保留在自己手上。然后自己生成一个【伪造的】公钥，发给客户端。\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("客户端收到伪造的公钥后，生成密文发给服务器。\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("中间人获得密文，用自己的私钥解密。同时用真正的公钥发给服务器。\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("服务器获得加密信息，用自己的私钥解密。\n")])])]),a("h2",{attrs:{id:"第三方依赖安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三方依赖安全"}},[t._v("#")]),t._v(" 第三方依赖安全")]),t._v(" "),a("p",[t._v("现如今进行应用开发，无论是后端服务器应用还是前端应用开发，绝大多数时候我们都是在借助开发框架和各种类库进行快速开发。然而，一些第三方的依赖或者插件存在很多安全性问题，也会存在这样那样的漏洞，所以使用起来得谨慎。")]),t._v(" "),a("ul",[a("li",[t._v("尽量减少第三方依赖，选用相对成熟的依赖包")]),t._v(" "),a("li",[t._v("定期使用 npm audit 检测依赖包的风险")])]),t._v(" "),a("p",[t._v("为了提高 npm 依赖的安全，npm 6.1 后添加了 npm audit 工具，这个工具可以搜索当前项目中使用的依赖是否存在安全问题，并提供了 npm audit fix 工具修复。")]),t._v(" "),a("p",[t._v("它的工作原理是维护了一个已知不良依赖的名单，如果代码中使用了直接从 GitHub 而不是 npm 仓库中获取依赖，或不知名的依赖。npm audit 也是无法发现威胁。总的来说在加入第三方依赖时，需要谨慎考虑，不滥用依赖在前端开发也是非常重要的。")]),t._v(" "),a("h2",{attrs:{id:"控制台注入代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#控制台注入代码"}},[t._v("#")]),t._v(" 控制台注入代码")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.tmall.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("详见天猫官网控制台"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"钓鱼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#钓鱼"}},[t._v("#")]),t._v(" 钓鱼")]),t._v(" "),a("p",[t._v("点击不可信链接输入用户名密码")]),t._v(" "),a("h2",{attrs:{id:"扩展"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#扩展"}},[t._v("#")]),t._v(" 扩展")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://cn.vuejs.org/v2/guide/security.html#Vue-%E7%9A%84%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue 的安全措施"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);